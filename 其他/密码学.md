#### 为什么需要加密？

1.  信息保密问题：敏感信息可能被获取
2.  信息篡改问题：传输过程中信息被篡改
3.  通信对象认证问题：伪装收信对象，截取信息

#### 密码系统

信息加密是指将信息转化为任何第三方都无法读懂，只有发送方和接收方能看懂的信息。例如暗号可以看作最简单的加密方式。如果存在一门外语只有通讯双方知道，那么将信息翻译成这种语言也算一种加密方式。当然，今天我们要聊的加密复杂的多

密码系统是由 算法+密钥 所组成。明文和密钥是原材料，算法是加工的方式，产出就是密文

我们都知道密钥是要保密的，那么密码算法是否也需要保密呢？这个问题常常会困扰初学者。事实上，试图通过对密码算法保密来提高安全性的行为（隐蔽式安全性）是非常愚蠢的。因为任何算法最终都会被破解，所以现在流行的密码算法都是公开的，从诞生之初就没想通过保密算法来提高安全。密码学一个重要的原则：杜绝隐蔽式安全性。

#### 简单替换密码

简单替换密码系统中，我们为26个字母建立映射关系，例如s->a、c->d、h->n、o->x、l->y…… 26个字母被映射为另外的字母，那么一个明文的单词被加密后就无法认出了。例如school，按照上面的映射关系，就变成了adnxxy

在这个密码系统中也存在密码算法和密钥

密码算法：26个字母按照固定的映射关系做替换

密钥：26个字母的替换关系

如果想要破解密钥，也就是要找出26个字母的替换关系。a有26种替换可能，b有除a选择替换的字母之外的25种可能。以此类推，存在的替换关系有26x25x24……x1,约为2的88次方。如果计算机可以一秒尝试一亿个密码，运气差的话要尝试1200亿年。因此暴力破解是行不通的。

但是由于密码算法中，替换关系是稳定的，所以可以采用频率分析的方式破解密码。原理是明文中同一个字母出现的频率和密文中被替换的字母出现的频率一致。在英文中，字母出现的频率是相对稳定的。因此可以根据字母出现的频率推算出替换关系，也就是密钥。从而完成破解

这种密码系统不安全的根源在于密码算法，该算法很容易让破解者推测出密钥，因此安全性极低

#### 对称密钥

密钥分为两类，对称密钥和非对称密钥（公钥密钥）

-   对称密钥：指加密和解密使用同样的密钥

-   非对称密钥：指加密和解密使用不同密钥

我们思考一下，简单替换密码是对称密码还是非对称密码呢？简单替换的密钥是字母映射表，加密和解密使用同样的字母映射表，所以是对称密钥

在计算机的世界里，机器直接操作的数据并不是文字，而是0和1组成的比特序列。我们所要加密的对象就是特定顺序的比特序列

二进制数字有一种运算叫做异或，运算符号 XOR。这种运算有一个特性，如果 A XOR B = C ，那么C XOR B =A。这个特性和加解密的过程十分相似，A 可以看作是明文，B 看作密钥，XOR 看作密码算法，C是加密后的密文。用密钥 B 可以将 C 还原为明文 A

异或算法太简单，不能直接用作密码算法。但我们所熟知的对称密钥 DES 和 AES 都是以异或运算作为基础

#### DES（Data Encryption Standard）

DES 曾经是 1977 年美国联邦信息处理标准中所采用的一种对称密码。曾经得到了广泛的使用。不过随着计算机算力的提升，DES 已经不再安全，可以在短时间内通过暴力破解。所以现在 DES 已经不再推荐使用

DES是一种分组加密算法，该算法每次处理固定长度的数据段，称之为分组。DES分组的大小是64位，如果加密的数据长度不是64位的倍数，可以按照某种具体的规则来填充位

从本质上来说，DES的安全性依赖于虚假表象，从密码学的术语来讲就是依赖于“混乱和扩散”的原则。混乱的目的是为隐藏任何明文同密文、或者密钥之间的关系，而扩散的目的是使明文中的有效位和密钥一起组成尽可能多的密文。两者结合到一起就使得安全性变得相对较高

DES算法加密过程：

-   初始置换（Initial Permutation, IP）

​	根据初始置换表将输入数据块（64）进行重新排列，然后划分为左右两部分（32位）

-   16轮迭代加密
    -   根据密钥（64位）生成当前轮的子密钥（48位）
    -   扩展置换：右部分（32位）被扩展为48位，以便与子密钥进行异或操作
    -   异或：将扩展后的数据与当前轮的子密钥进行异或
    -   S盒压缩：数据经过8个S-盒处理，将48位数据压缩回32位。每个S-盒接收6位输入，并根据其查找表输出4位结果
    -   P盒置换：采用置换表，对32位的数据进行重新排列，得到加密左部分的比特序列
    -   异或：左侧32位与P盒置换得到的比特序列做异或操作，得到加密的密文
    -   交换左右侧（下轮迭代加密右侧），最后一次不能交换，为了解密用

-   末置换（Final Permutation）

​	左右部分合并，且根据末置换表来对数据进行重新排列，得到最终加密的密文。末置换表和初始置换表存在一定的关系，如果只经过初始置换和末置换，那么元素不会发生任何改变

DES迭代轮次生成子密钥：

-   根据密钥进行置换，得到56位密钥
-   由当前轮次，左右两部分（28位）分别进行向左循环移位，向左移位的多少由当前轮次决定
-   根据置换表，再次进行压缩，得到48位的密钥